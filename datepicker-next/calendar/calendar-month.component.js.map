{"version":3,"file":"calendar-month.component.js","sourceRoot":"","sources":["../../../.tmp/datepicker-next/calendar/calendar-month.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { Component, OnInit, HostBinding, OnDestroy } from '@angular/core';\nimport { ThyDatepickerNextStore, datepickerNextActions } from '../datepicker-next.store';\nimport { sliceArray, getTimestamp } from '../util';\nimport { DatepickerNextCalendarViewModeEnum } from '../datepicker-next.interface';\nimport { takeUntil } from 'rxjs/operators';\nimport { Subject } from 'rxjs';\n\ninterface DatepickerNextCalendarMonthInfo {\n    month: number;\n    isActive?: boolean;\n    isDisabled?: boolean;\n}\n\nconst monthEnum = {\n    0: '一月',\n    1: '二月',\n    2: '三月',\n    3: '四月',\n    4: '五月',\n    5: '六月',\n    6: '七月',\n    7: '八月',\n    8: '九月',\n    9: '十月',\n    10: '十一月',\n    11: '十二月'\n};\n\n@Component({\n    selector: 'thy-datepicker-next-calendar-month',\n    template: \"<thy-datepicker-next-calendar-head (preClick)=\\\"preYearClick()\\\" (nextClick)=\\\"nextYearClick()\\\"></thy-datepicker-next-calendar-head> <div class=\\\"calendar-content\\\"> <div class=\\\"calendar-grid\\\"> <div class=\\\"calendar-row\\\" *ngFor=\\\"let row of calendarRows;let i=index; trackBy:trackByFn\\\"> <div class=\\\"calendar-cell\\\" *ngFor=\\\"let item of row;let i=index; trackBy:trackByFn\\\" [ngClass]=\\\"{'active':item.isActive}\\\" (click)=\\\"cellClick(item)\\\"> <span>{{monthEnum[item.month]}}</span> </div> </div> </div> </div> \"\n})\nexport class ThyDatepickerNextCalendarMonthComponent implements OnInit, OnDestroy {\n    @HostBinding('class') styleClass = 'calendar-container calendar-month-container';\n\n    calendarRows: any;\n\n    monthEnum = monthEnum;\n\n    private ngUnsubscribe$ = new Subject();\n\n    constructor(public store: ThyDatepickerNextStore) {}\n\n    ngOnInit() {\n        this._combinationMonths();\n        this.store\n            .select(ThyDatepickerNextStore.calendarCurrent)\n            .pipe(takeUntil(this.ngUnsubscribe$))\n            .subscribe(n => {\n                this._combinationMonths();\n            });\n    }\n\n    preYearClick() {\n        this.store.dispatch(datepickerNextActions.changeCalendarCurrent, {\n            year: this.store.snapshot.calendarCurrent.year - 1\n        });\n    }\n\n    nextYearClick() {\n        this.store.dispatch(datepickerNextActions.changeCalendarCurrent, {\n            year: this.store.snapshot.calendarCurrent.year + 1\n        });\n    }\n\n    cellClick(item: DatepickerNextCalendarMonthInfo) {\n        if (item.isDisabled) {\n            return;\n        }\n        this.store.dispatch(datepickerNextActions.changeCalendarCurrent, {\n            month: item.month,\n            viewMode: DatepickerNextCalendarViewModeEnum.day\n        });\n    }\n\n    _combinationMonths() {\n        const months = [];\n        for (let index = 0; index < 12; index++) {\n            const month: DatepickerNextCalendarMonthInfo = {\n                month: index\n            };\n            // active\n            if (\n                this.store.snapshot.calendarSelected &&\n                this.store.snapshot.calendarCurrent.year === this.store.snapshot.calendarSelected.year &&\n                index === this.store.snapshot.calendarSelected.month\n            ) {\n                month.isActive = true;\n            }\n            // disabled rules\n            const _timestamp = getTimestamp(new Date(this.store.snapshot.calendarCurrent.year, this.store.snapshot.calendarCurrent.month));\n            if (\n                this.store.snapshot.disableRules &&\n                (_timestamp < this.store.snapshot.disableRules['<'] || _timestamp > this.store.snapshot.disableRules['>'])\n            ) {\n                month.isDisabled = true;\n            }\n            months.push(month);\n        }\n        this.calendarRows = sliceArray(months, 3);\n    }\n\n    trackByFn(index: number) {\n        return index;\n    }\n\n    ngOnDestroy(): void {\n        this.ngUnsubscribe$.next();\n        this.ngUnsubscribe$.complete();\n    }\n}\n"]}