{"version":3,"file":"datepicker-container.component.js","sourceRoot":"","sources":["../../.tmp/datepicker-next/datepicker-container.component.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n    Component,\n    OnInit,\n    HostBinding,\n    OnDestroy,\n    Input,\n    forwardRef,\n    AfterContentInit,\n    Output,\n    EventEmitter\n} from '@angular/core';\nimport {\n    ThyDatepickerNextStore,\n    datepickerNextActions\n} from './datepicker-next.store';\nimport {\n    ThyDatepickerNextEventsEnum,\n    ThyDatepickerNextInfo,\n    DatepickerNextValueType,\n    DatepickerNextTimeModeType,\n    ValueInRxPipeInterface,\n    ValueOutRxPipeInterface,\n    DatepickerNextViewFeatureConfig,\n    DatepickerNextDisableRules\n} from './datepicker-next.interface';\nimport { of } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport {\n    exploreValueTypePipe,\n    combiningDataAccordingToDatepickerType,\n    combiningDataAccordingToOriginalDataType,\n    getTimestamp\n} from './util';\nimport { NG_VALUE_ACCESSOR, ControlValueAccessor } from '@angular/forms';\n\n@Component({\n    selector: 'thy-datepicker-next-container',\n    template: \"<ng-container *ngIf=\\\"loadingDone\\\"> <thy-datepicker-next-calendar></thy-datepicker-next-calendar> <ng-container *ngIf=\\\"store.snapshot.viewFeatureConfig.shortcut\\\"> <thy-datepicker-next-shortcut></thy-datepicker-next-shortcut> </ng-container> <ng-container *ngIf=\\\"store.snapshot.viewFeatureConfig.time\\\"> <thy-datepicker-next-time></thy-datepicker-next-time> </ng-container> <ng-container *ngIf=\\\"store.snapshot.viewFeatureConfig.operation\\\"> <thy-datepicker-next-operation></thy-datepicker-next-operation> </ng-container> </ng-container> \",\n    providers: [\n        ThyDatepickerNextStore,\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => ThyDatepickerNextContainerComponent),\n            multi: true\n        }\n    ]\n})\nexport class ThyDatepickerNextContainerComponent\n    implements OnInit, OnDestroy, AfterContentInit, ControlValueAccessor {\n    loadingDone = false;\n\n    @HostBinding('class.thy-datepicker-next-container') styleClass = true;\n\n    @Input()\n    set thyNgModel(value: DatepickerNextValueType) {\n        this._initViewComponent(value);\n        if (this._isAfterContentInit) {\n        }\n    }\n\n    @Input() thyShortcut = true;\n\n    @Input() thyWithTime = false;\n\n    @Input() thyOperation = false;\n\n    @Input() thyTimeType = DatepickerNextTimeModeType.simply;\n\n    @Input()\n    set thyMaxDate(value: Date | number) {\n        of(value)\n            .pipe(\n                map(exploreValueTypePipe),\n                map(combiningDataAccordingToDatepickerType)\n            )\n            .subscribe((result: ValueInRxPipeInterface) => {\n                const _date = new Date(\n                    result.value.year,\n                    result.value.month,\n                    result.value.day,\n                    result.value.hour || 23,\n                    result.value.minute || 59\n                );\n\n                this.store.dispatch(datepickerNextActions.setDisableRules, {\n                    '>': getTimestamp(_date)\n                });\n            })\n            .unsubscribe();\n    }\n\n    @Input()\n    set thyMinDate(value: Date | number) {\n        of(value)\n            .pipe(\n                map(exploreValueTypePipe),\n                map(combiningDataAccordingToDatepickerType)\n            )\n            .subscribe((result: ValueInRxPipeInterface) => {\n                const _date = new Date(\n                    result.value.year,\n                    result.value.month,\n                    result.value.day,\n                    result.value.hour || 0,\n                    result.value.minute || 0\n                );\n\n                this.store.dispatch(datepickerNextActions.setDisableRules, {\n                    '<': getTimestamp(_date)\n                });\n            })\n            .unsubscribe();\n    }\n\n    @Input() thyModeType: DatepickerNextTimeModeType =\n        DatepickerNextTimeModeType.simply;\n\n    @Output() thyNgModelChange: EventEmitter<\n        DatepickerNextValueType\n    > = new EventEmitter<DatepickerNextValueType>();\n\n    private _isAfterContentInit = false;\n\n    private _onChange = Function.prototype;\n\n    private _onTouched = Function.prototype;\n\n    private _originValueType: DatepickerNextValueType;\n\n    private _originValue: DatepickerNextValueType;\n\n    constructor(public store: ThyDatepickerNextStore) {}\n\n    ngOnInit() {\n        this._initViewFeature();\n        this.loadingDone = true;\n    }\n\n    ngAfterContentInit() {\n        this._isAfterContentInit = true;\n    }\n\n    //#region init view feature\n    private _initViewFeature() {\n        const payload: DatepickerNextViewFeatureConfig = {\n            shortcut: this.thyShortcut,\n            time: this.thyWithTime,\n            timeComponentType: this.thyTimeType,\n            operation: this.thyWithTime\n        };\n        this.store.dispatch(\n            datepickerNextActions.changeViewFeatureConfig,\n            payload\n        );\n    }\n    //#endregion\n\n    writeValue(value: any) {\n        this._initViewComponent(value);\n    }\n\n    registerOnChange(fn: (value: any) => any): void {\n        this._onChange = fn;\n    }\n\n    registerOnTouched(fn: () => any): void {\n        this._onTouched = fn;\n    }\n\n    private _initViewComponent(value: DatepickerNextValueType) {\n        this._originValue = value;\n        if (this._originValue && this._originValue.with_time) {\n            this.store.dispatch(datepickerNextActions.changeViewFeatureConfig, {\n                time: true,\n                operation: true\n            });\n        }\n\n        of(value)\n            .pipe(\n                map(exploreValueTypePipe),\n                map(combiningDataAccordingToDatepickerType)\n            )\n            .subscribe((result: ValueInRxPipeInterface) => {\n                const payload: any = {};\n                if (result.value.year !== undefined) {\n                    payload.calendarDate = {\n                        year: result.value.year,\n                        month: result.value.month,\n                        day: result.value.day\n                    };\n                }\n                if (result.value.hour !== undefined) {\n                    payload.calendarTime = {\n                        hour: result.value.hour,\n                        minute: result.value.minute\n                    };\n                }\n                this._originValueType = result.type;\n                this.store.dispatch(datepickerNextActions.initState, payload);\n            })\n            .unsubscribe();\n    }\n\n    public behaviorValueChange(event?: ThyDatepickerNextEventsEnum) {\n        let result: ThyDatepickerNextInfo = {};\n        switch (event) {\n            case ThyDatepickerNextEventsEnum.done:\n                result = this._getCalendarSelected();\n                break;\n            case ThyDatepickerNextEventsEnum.calendarDone:\n            case ThyDatepickerNextEventsEnum.shortcutDone:\n                if (!this.store.snapshot.viewFeatureConfig.operation) {\n                    result = this._getCalendarSelected();\n                }\n                break;\n            case ThyDatepickerNextEventsEnum.clean:\n                result = null;\n                break;\n        }\n\n        console.log(result);\n        const value$ = of<ValueOutRxPipeInterface>({\n            value: result\n        });\n        const subscribe = value$\n            .pipe(\n                map(n => {\n                    n.originType = this._originValueType;\n                    return n;\n                }),\n                map(combiningDataAccordingToOriginalDataType)\n            )\n            .subscribe((res: ValueOutRxPipeInterface) => {\n                this.thyNgModelChange.emit(res);\n                if (event === ThyDatepickerNextEventsEnum.done) {\n                    this._onChange(res);\n                    this._onTouched(res);\n                } else {\n                    if (this.store.snapshot.viewFeatureConfig.time === false) {\n                        this._onChange(res);\n                        this._onTouched(res);\n                    }\n                }\n            });\n        subscribe.unsubscribe();\n    }\n\n    private _getCalendarSelected(): ThyDatepickerNextInfo {\n        const result = {\n            year: this.store.snapshot.calendarSelected.year,\n            month: this.store.snapshot.calendarSelected.month,\n            day: this.store.snapshot.calendarSelected.day\n        };\n        if (this.store.snapshot.timeSelected) {\n            Object.assign(result, {\n                hour: this.store.snapshot.timeSelected.hour,\n                minute: this.store.snapshot.timeSelected.minute\n            });\n        }\n        return result;\n    }\n\n    ngOnDestroy() {}\n}\n"]}