{"version":3,"file":"calendar-year.component.js","sourceRoot":"","sources":["../../../.tmp/datepicker-next/calendar/calendar-year.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { Component, OnInit, HostBinding, OnDestroy } from '@angular/core';\nimport { ThyDatepickerNextStore, datepickerNextActions } from '../datepicker-next.store';\nimport { sliceArray, getTimestamp } from '../util';\nimport { DatepickerNextCalendarViewModeEnum } from '../datepicker-next.interface';\nimport { Subject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\n\nexport const CALENDAR_YEAR_CONSTANT = {\n    yearInterval: 16,\n    currentReciprocalPosition: 6\n};\n\ninterface DatepickerNextCalendarYearInfo {\n    year: number;\n    isActive?: boolean;\n    isDisabled?: boolean;\n}\n\n@Component({\n    selector: 'thy-datepicker-next-calendar-year',\n    template: \"<thy-datepicker-next-calendar-head (preClick)=\\\"preClick()\\\" (nextClick)=\\\"nextClick()\\\"></thy-datepicker-next-calendar-head> <div class=\\\"calendar-content\\\"> <div class=\\\"calendar-grid\\\"> <div class=\\\"calendar-row\\\" *ngFor=\\\"let row of yearRows;let i=index; trackBy:trackByFn\\\"> <div class=\\\"calendar-cell\\\" *ngFor=\\\"let item of row;let i=index; trackBy:trackByFn\\\" (click)=\\\"cellClick(item)\\\" [ngClass]=\\\"{'active':item.isActive}\\\"> <span *ngIf=\\\"!item.isToday\\\">{{item.year}}</span> </div> </div> </div> </div> \"\n})\nexport class ThyDatepickerNextCalendarYearComponent implements OnInit, OnDestroy {\n    @HostBinding('class') styleClass = 'calendar-container calendar-year-container';\n\n    yearRows: any;\n\n    private ngUnsubscribe$ = new Subject();\n\n    constructor(public store: ThyDatepickerNextStore) {}\n\n    ngOnInit() {\n        this.store\n            .select(ThyDatepickerNextStore.calendarCurrent)\n            .pipe(takeUntil(this.ngUnsubscribe$))\n            .subscribe(n => {\n                this._combinationYears();\n            });\n    }\n\n    preClick() {\n        this.store.dispatch(datepickerNextActions.changeCalendarCurrent, {\n            year: this.store.snapshot.calendarCurrent.year - CALENDAR_YEAR_CONSTANT.yearInterval\n        });\n    }\n\n    nextClick() {\n        this.store.dispatch(datepickerNextActions.changeCalendarCurrent, {\n            year: this.store.snapshot.calendarCurrent.year + CALENDAR_YEAR_CONSTANT.yearInterval\n        });\n    }\n\n    cellClick(item: DatepickerNextCalendarYearInfo) {\n        if (item.isDisabled) {\n            return;\n        }\n        this.store.dispatch(datepickerNextActions.changeCalendarCurrent, {\n            year: item.year,\n            viewMode: DatepickerNextCalendarViewModeEnum.month\n        });\n    }\n\n    _combinationYears() {\n        const years = [];\n        const lastYear = this.store.snapshot.calendarCurrent.year + CALENDAR_YEAR_CONSTANT.currentReciprocalPosition;\n        for (let index = 1; index <= CALENDAR_YEAR_CONSTANT.yearInterval; index++) {\n            const year: DatepickerNextCalendarYearInfo = {\n                year: lastYear - index\n            };\n            // active\n            if (this.store.snapshot.calendarSelected && year.year === this.store.snapshot.calendarSelected.year) {\n                year.isActive = true;\n            }\n            // disabled rules\n            const _timestamp = getTimestamp(new Date(this.store.snapshot.calendarCurrent.year));\n            if (\n                this.store.snapshot.disableRules &&\n                (_timestamp < this.store.snapshot.disableRules['<'] || _timestamp > this.store.snapshot.disableRules['>'])\n            ) {\n                year.isDisabled = true;\n            }\n            years.push(year);\n        }\n        years.reverse();\n        this.yearRows = sliceArray(years, 4);\n    }\n\n    trackByFn(index: number) {\n        return index;\n    }\n\n    ngOnDestroy(): void {\n        this.ngUnsubscribe$.next();\n        this.ngUnsubscribe$.complete();\n    }\n}\n"]}